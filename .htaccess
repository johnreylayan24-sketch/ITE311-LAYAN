<<<<<<< HEAD
# Disable directory browsing
Options -Indexes

# Prevent direct access to system and application directories
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Handle Authorization Header
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
    
    # Redirect to public directory
    RewriteCond %{REQUEST_URI} !^/public/
    RewriteRule ^(.*)$ public/$1 [L]
    
    # Ensure www is removed (or added if you prefer)
    RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
    RewriteRule ^(.*)$ http://%1/$1 [R=301,L]
    
    # Force HTTPS (uncomment if you have SSL configured)
    # RewriteCond %{HTTPS} off
    # RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>
=======
RewriteEngine On

# Block URLs with double slashes anywhere - FIRST RULE
RewriteCond %{REQUEST_URI} //
RewriteRule ^ - [F,L]

RewriteBase /ITE311-LAYAN/

# Block direct access to public URLs - return 403 Forbidden
RewriteCond %{REQUEST_URI} ^/ITE311-LAYAN/public/ [NC]
RewriteRule ^ - [F,L]

# Route all non-public requests to public directory
RewriteCond %{REQUEST_URI} !^/ITE311-LAYAN/public/
RewriteRule ^(.*)$ public/$1 [L,QSA]

# Disable directory browsing
Options -Indexes
>>>>>>> 9bc49831b38c627ac5b7e400f2b51d63a4e97daf

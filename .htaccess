# Disable directory browsing
Options -Indexes

# Enable the rewrite engine
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Set the base directory
    RewriteBase /ITE311-LAYAN/
    
    # Block URLs with double slashes anywhere
    RewriteCond %{REQUEST_URI} //
    RewriteRule ^ - [F,L]
    
    # Block direct access to public URLs - return 403 Forbidden
    RewriteCond %{THE_REQUEST} /public/ [NC]
    RewriteRule ^ - [F,L]
    
    # Handle Authorization Header
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
    
    # Redirect to public directory if not already there
    RewriteCond %{REQUEST_URI} !^/ITE311-LAYAN/public/
    RewriteRule ^(.*)$ public/$1 [L,QSA]
    
    # Ensure www is removed (or added if you prefer)
    RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
    RewriteRule ^(.*)$ http://%1/$1 [R=301,L]
    
    # Force HTTPS (uncomment if you have SSL configured)
    # RewriteCond %{HTTPS} off
    # RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>
